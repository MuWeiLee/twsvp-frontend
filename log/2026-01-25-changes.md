# 变更记录 (2026-01-25)

## 今日改动摘要
- 完成 Feed/个人/搜索/标的页的互动与跳转细化，统一观点卡片交互。
- 观点卡片样式与交互对齐观点流（含详情页/个人中心/他人主页/搜索/标的）。
- 点赞改为读取 `feed_likes` 表并写回计数（不再依赖 localStorage）。
- 设置新增涨跌颜色切换，方向颜色由设置驱动（红涨绿跌/绿涨红跌）。
- 个人中心统计区调整为：观点总数 / 观点胜率 / 绩效表现。
- 提示语固定在底部 Tab 上方。
- 新增时效选项「极短期 1-5天」并更新 feeds 约束。
- 搜索结果卡片对齐观点流（移除左侧空位布局）。
- 搜索结果改为 Tab（股票/观点/用户），并支持用户昵称搜索。
- 观点详情卡片对齐观点流样式与交互。
- 通知中心改为读取 `notifications` 表，并支持 like/share/bookmark/expire_soon/expired 文案。
- 新增股价日线表 `stock_prices` 的 SQL 定义。
- 新增用户绩效日快照表 `user_performance_daily` 的 SQL 定义。
- 提交设计稿目录：`TWSVP-Requirement/X-style_requirement/feedPage/feedPage.pen`。

## 代码与文件改动
- Commit: `dc5c16c`（feat: wire notifications and update feed views）
  - `src/views/FeedView.vue`：观点卡点击拆分（股票/作者/点赞）、状态标签统一。
  - `src/views/SearchView.vue`：搜索联想下拉 + 观点卡交互统一。
  - `src/views/ProfileView.vue` / `src/views/PersonalViewerView.vue`：新增进行中 Tab，并统一跳转。
  - `src/views/StockFeedView.vue`：个股详情接入数据、筛选与作者跳转。
  - `src/views/CreateFeedView.vue`：标的联想改为下拉覆盖式。
  - `src/views/NotificationsView.vue`：通知中心接入数据与跳转。
  - `src/services/feeds.js` / `src/services/stocks.js`：抽出统一状态与 stock 查询。
  - `src/services/notifications.js`：新增通知读取服务。
  - `TWSVP-Requirement/X-style_requirement/feedPage/feedPage.pen`：新增/提交。

## 数据结构
- 新增：`TWSVP-Requirement/2-data_requirement/2-aboutStock/stock_prices.sql`
  - 字段：open/high/low/close/average/volume/turnover、trade_date、stock_id。
  - 用途：胜率与绩效计算的日均价基准。
- 新增：`TWSVP-Requirement/2-data_requirement/1-aboutUser/user_performance_daily.sql`
  - 字段：as_of_date、wins/losses、win_rate、avg_return、total_return。
  - 用途：按日聚合用户绩效与胜率快照。

## 外部数据源检查（FinMind）
- 尝试访问 `https://api.finmindtrade.com/api/v4/data` 超时。
- `https://finmindtrade.com/api/v4/data` 返回 Not Found。
- 结论：目前环境无法确认 FinMind 数据是否可拉取；需在可访问环境再验证。

## 待办 / 未完成
- 新增绩效统计表（个人绩效/胜率统计）。
- 胜率逻辑：发布日均价 vs 现价，需考虑方向（看多上涨=胜/看空下跌=胜）。
- 绩效逻辑：发布日均价 vs 现价，计算涨跌幅与方向收益。
